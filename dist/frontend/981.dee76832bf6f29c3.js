"use strict";(self.webpackChunkkidsheaven=self.webpackChunkkidsheaven||[]).push([[981],{8981:(X,A,n)=>{n.r(A),n.d(A,{UserModule:()=>V});var c=n(6019),q=n(3061),T=n(7043),y=n(7906),N=n(7031),l=n(7537),M=n(397),m=n(5759),C=n(6369),S=n(4522),f=n(8337),v=n(481),h=n(4750),d=n(1002),g=n(5043),e=n(3668),Z=n(5979),O=n(9447),_=n(7030),P=n(8329);const J=function(){return["editUser"]};let E=(()=>{class i{constructor(r,t,o,s,a,b,p){this.route=r,this.router=t,this.userService=o,this.afStorage=s,this.authService=a,this.messageService=b,this.location=p,this.faPhoneAlt=g.DOT,this.faEnvelope=g.FU$,this.faHome=g.J9Y}ngOnInit(){this.userService.getUser().subscribe(r=>{this.user=r,this.userService.getUserRatingById(r.userId).subscribe(t=>{this.val=t.RatedUserStars})})}back(){this.location.back()}uploadImage(r){const s=r.target.files.item(0);let a=`UserPFP/${null==s?void 0:s.name}_${(new Date).getTime()}`,b=this.afStorage.ref(a);this.afStorage.upload(a,s).then(()=>{b.getDownloadURL().subscribe(p=>{p&&this.userService.updateUser({userName:this.user.userName,email:this.user.userEmail,phoneNumber:this.user.userPhoneNumber,userPhotoUrl:p,districtId:this.user.districtId},this.user.userId).subscribe(()=>{this.messageService.add({key:"main",severity:"success",summary:"Sucesso",detail:"Imagem alterada"}),this.userService.getUser().subscribe(G=>{this.user=G})})})}).catch(p=>{console.log(p.code),"storage/unauthorized"==p.code&&this.messageService.add({key:"main",severity:"error",summary:"Erro",detail:"O ficheiro tem de ser imagem e no maximo 2 MB"})})}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(d.gz),e.Y36(d.F0),e.Y36(Z.K),e.Y36(O.Q1),e.Y36(_.e),e.Y36(v.ez),e.Y36(c.Ye))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-profile"]],decls:29,vars:13,consts:[[1,"flex","justify-content-center","profile"],[1,"surface-card","p-4","shadow-2","border-round","lg:w-7"],[1,"flex","justify-content-between"],[1,"buttonExit"],["pButton","","pRipple","","label","Voltar","icon","pi pi-arrow-left",3,"click"],[1,"buttonEdit"],["pButton","","pRipple","","label","Editar","icon","pi pi-user-edit",3,"routerLink"],[1,"grid","pt-6"],[1,"image-upload","col-2","flex","align-items-center","justify-content-center"],["for","upload-photo-input",1,"upload-photo-img"],[1,"w-7rem","cursor-pointer","flex","align-items-center",3,"src"],["type","file","id","upload-photo-input",3,"change"],[1,"user","pt-3","col-6"],[1,"mb-2"],[3,"cancel","readonly","ngModel","ngModelChange"],[1,"userInfo","p-4","col-4"],[1,"userPhone","flex","align-items-center","mb-3"],[3,"icon"],[1,"ml-2"],[1,"userEmail","flex","align-items-center","mb-3"],[1,"userDistrict","flex","align-items-center","mb-3"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"button",4),e.NdJ("click",function(){return t.back()}),e.qZA(),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"button",6),e.qZA(),e.qZA(),e.TgZ(7,"div",7),e.TgZ(8,"div",8),e.TgZ(9,"label",9),e._UZ(10,"img",10),e.qZA(),e.TgZ(11,"input",11),e.NdJ("change",function(s){return t.uploadImage(s)}),e.qZA(),e.qZA(),e.TgZ(12,"div",12),e.TgZ(13,"h3",13),e._uU(14),e.qZA(),e.TgZ(15,"p-rating",14),e.NdJ("ngModelChange",function(s){return t.val=s}),e.qZA(),e.qZA(),e.TgZ(16,"div",15),e.TgZ(17,"div",16),e._UZ(18,"fa-icon",17),e.TgZ(19,"span",18),e._uU(20),e.qZA(),e.qZA(),e.TgZ(21,"div",19),e._UZ(22,"fa-icon",17),e.TgZ(23,"span",18),e._uU(24),e.qZA(),e.qZA(),e.TgZ(25,"div",20),e._UZ(26,"fa-icon",17),e.TgZ(27,"span",18),e._uU(28),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(6),e.Q6J("routerLink",e.DdM(12,J)),e.xp6(4),e.Q6J("src",null!=(null==t.user?null:t.user.userPhotoUrl)?null==t.user?null:t.user.userPhotoUrl:"./assets/user_default.png",e.LSH),e.xp6(4),e.Oqu(null==t.user?null:t.user.userName),e.xp6(1),e.Q6J("cancel",!1)("readonly",!0)("ngModel",t.val),e.xp6(3),e.Q6J("icon",t.faPhoneAlt),e.xp6(2),e.Oqu(null==t.user?null:t.user.userPhoneNumber),e.xp6(2),e.Q6J("icon",t.faEnvelope),e.xp6(2),e.Oqu(null==t.user?null:t.user.userEmail),e.xp6(2),e.Q6J("icon",t.faHome),e.xp6(2),e.Oqu(null==t.user?null:t.user.districtName))},directives:[h.Hq,m.H,d.rH,f.iG,l.JJ,l.On,P.BN],styles:[".profile[_ngcontent-%COMP%]{margin-top:27vh;font-family:Inter,sans-serif}.image-upload[_ngcontent-%COMP%]{position:relative;height:150px;width:150px;overflow:hidden}.image-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.user[_ngcontent-%COMP%]{color:#335}.userInfo[_ngcontent-%COMP%]{color:#335}.userAchivements[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#335}"]}),i})();function x(i,u){1&i&&(e.TgZ(0,"p",11),e._uU(1,"Nome obrigat\xf3rio"),e.qZA())}function R(i,u){1&i&&(e.TgZ(0,"p",11),e._uU(1,"Exedeu o n\xfamero m\xe1ximo de 100 caracteres"),e.qZA())}function Y(i,u){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,x,2,0,"p",10),e.YNc(2,R,2,0,"p",10),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.name.errors?null:r.name.errors.required),e.xp6(1),e.Q6J("ngIf",null==r.name.errors?null:r.name.errors.maxlength)}}function Q(i,u){1&i&&(e.TgZ(0,"p",11),e._uU(1,"N\xba de telemovel obrigat\xf3rio"),e.qZA())}function w(i,u){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Q,2,0,"p",10),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.phoneNumber.errors?null:r.phoneNumber.errors.required)}}function B(i,u){1&i&&(e.TgZ(0,"p",11),e._uU(1,"Escolha um distrito"),e.qZA())}function F(i,u){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,B,2,0,"p",10),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",null==r.district.errors?null:r.district.errors.required)}}const U=function(i){return{"ng-dirty":i}};let H=(()=>{class i{constructor(r,t,o,s,a){this.authService=r,this.formBuilder=t,this.router=o,this.messageService=s,this.userService=a}ngOnInit(){this.form=this.formBuilder.group({name:["",[l.kI.required,l.kI.maxLength(100)]],phoneNumber:["",[l.kI.required]],district:["",l.kI.required]}),this.authService.getDistricts().subscribe(r=>{this.districts=r}),this.userService.getUser().subscribe(r=>{var t,o,s;this.user=r,null===(t=this.name)||void 0===t||t.setValue(r.userName),null===(o=this.phoneNumber)||void 0===o||o.setValue(r.userPhoneNumber),null===(s=this.district)||void 0===s||s.setValue(this.districts.find(a=>a.districtName==r.districtName))})}edit(){var r,t,o;const s={userName:null===(r=this.name)||void 0===r?void 0:r.value,email:this.user.userEmail,phoneNumber:null===(t=this.phoneNumber)||void 0===t?void 0:t.value,userPhotoUrl:this.user.userPhotoUrl,districtId:null===(o=this.district)||void 0===o?void 0:o.value.districtsId};this.userService.updateUser(s,this.user.userId).subscribe(()=>{this.messageService.add({key:"main",severity:"success",summary:"Sucesso",detail:"Dados alterados"}),this.userService.getUser().subscribe(a=>{this.user=a}),this.router.navigate(["/user"])})}get name(){return this.form.get("name")}get phoneNumber(){return this.form.get("phoneNumber")}get district(){return this.form.get("district")}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(_.e),e.Y36(l.qu),e.Y36(d.F0),e.Y36(v.ez),e.Y36(Z.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-user"]],decls:18,vars:15,consts:[[1,"flex","justify-content-center","registerMenu",3,"formGroup","ngSubmit"],[1,"surface-card","p-4","shadow-2","border-round","w-full","lg:w-6"],["for","name",1,"block","text-900","font-medium","mb-2"],["id","name","type","text","pInputText","","formControlName","name",1,"w-full","mb-3",3,"ngClass"],[4,"ngIf"],["for","phoneNumber",1,"block","text-900","font-medium","mb-2"],["id","phoneNumber","type","text","pInputText","","formControlName","phoneNumber",1,"w-full","mb-3",3,"ngClass"],[1,"block","text-900","font-medium","mb-2"],["optionLabel","districtName","placeholder","Selecione o distrito","formControlName","district",3,"options","ngClass"],["type","submit","pButton","","pRipple","","label","Salvar","icon","pi pi-user-plus",1,"w-full",3,"disabled"],["class","p-error mt-0",4,"ngIf"],[1,"p-error","mt-0"]],template:function(r,t){1&r&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return t.edit()}),e.TgZ(1,"div",1),e.TgZ(2,"div"),e.TgZ(3,"label",2),e._uU(4,"Nome"),e.qZA(),e._UZ(5,"input",3),e.YNc(6,Y,3,2,"div",4),e.qZA(),e.TgZ(7,"div"),e.TgZ(8,"label",5),e._uU(9,"Telemovel"),e.qZA(),e._UZ(10,"input",6),e.YNc(11,w,2,1,"div",4),e.qZA(),e.TgZ(12,"div"),e.TgZ(13,"label",7),e._uU(14,"Distrito"),e.qZA(),e._UZ(15,"p-dropdown",8),e.YNc(16,F,2,1,"div",4),e.qZA(),e._UZ(17,"button",9),e.qZA(),e.qZA()),2&r&&(e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngClass",e.VKq(9,U,t.name.invalid&&t.name.touched)),e.xp6(1),e.Q6J("ngIf",t.name.invalid&&(t.name.dirty||t.name.touched)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,U,t.phoneNumber.invalid&&t.phoneNumber.touched)),e.xp6(1),e.Q6J("ngIf",t.phoneNumber.invalid&&(t.phoneNumber.dirty||t.phoneNumber.touched)),e.xp6(4),e.Q6J("options",t.districts)("ngClass",e.VKq(13,U,t.district.invalid&&t.district.touched)),e.xp6(1),e.Q6J("ngIf",t.district.invalid&&(t.district.dirty||t.district.touched)),e.xp6(1),e.Q6J("disabled",!t.form.valid))},directives:[l._Y,l.JL,l.sg,l.Fj,T.o,l.JJ,l.u,c.mk,c.O5,C.Lt,h.Hq,m.H],styles:[".registerMenu[_ngcontent-%COMP%]{margin-top:30vh;font-family:Inter,sans-serif}  .p-dropdown{margin-bottom:2rem;width:100%}.text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding-top:0}"]}),i})();var L=n(9314),I=n(8221);const k=function(i){return["/adverts/advert",i]};function z(i,u){if(1&i&&(e.TgZ(0,"div",23),e._UZ(1,"img",24),e.TgZ(2,"div",25),e.TgZ(3,"p",26),e._uU(4),e.qZA(),e.TgZ(5,"h3"),e._uU(6),e.qZA(),e.qZA(),e.qZA()),2&i){const r=u.$implicit;e.Q6J("routerLink",e.VKq(4,k,r.productsId)),e.xp6(1),e.Q6J("src",r.productsPhotoUrl,e.LSH),e.xp6(3),e.Oqu(r.productsTitle),e.xp6(2),e.hij(" ",r.productsPrice,"\u20ac ")}}const D=[{path:"",component:E},{path:"editUser",component:H},{path:"advert-user-profile/:id",component:(()=>{class i{constructor(r,t,o,s,a){this.location=r,this.userService=t,this.route=o,this.router=s,this.advertService=a,this.faPhoneAlt=g.DOT,this.faEnvelope=g.FU$,this.faHome=g.J9Y}ngOnInit(){this.route.params.subscribe(r=>{this.id=r.id,null!=this.id&&""!=this.id&&!isNaN(Number(this.id))||this.router.navigate([""])}),this.userService.getUserById(parseInt(this.id)).subscribe(r=>{this.user=r}),this.userService.getUserRatingById(parseInt(this.id)).subscribe(r=>{this.rating=r.RatedUserStars}),this.userService.getUser().subscribe(r=>{this.userId=r.userId,this.userService.getUserRating(parseInt(this.id),this.userId).subscribe(t=>{this.val=null==t?void 0:t.RatedUserStars,console.log(t),this.userIdRated=t.UserIdRated})}),this.getAdvertsByUserId(1)}getAdvertsByUserId(r){this.advertService.getAdvertsByUserId(parseInt(this.id),r).subscribe(t=>{this.advertsArray=t,this.totalCount=t.totalCount,this.pageSize=t.pageSize})}Rate(){const r={userIdRated:this.userIdRated,ratedUserStars:this.val,userIdEvaluated:parseInt(this.id)};console.log(r),this.userId!=this.userIdRated?this.userService.userRateUser(r).subscribe(()=>{this.userService.getUserRatingById(parseInt(this.id)).subscribe(t=>{this.rating=t.RatedUserStars})}):this.userService.userUpdateRateUser(r).subscribe(()=>{this.userService.getUserRatingById(parseInt(this.id)).subscribe(t=>{this.rating=t.RatedUserStars})})}back(){this.location.back()}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(c.Ye),e.Y36(Z.K),e.Y36(d.gz),e.Y36(d.F0),e.Y36(L.F))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-advert-user-profile"]],decls:36,vars:16,consts:[[1,"flex","justify-content-center","profile","mb-6"],[1,"surface-card","p-4","shadow-2","border-round","lg:w-7"],[1,"flex","justify-content-between"],["pButton","","pRipple","","label","Voltar","icon","pi pi-arrow-left",1,"flex",3,"click"],["pButton","","pRipple","","label","Enviar Mensagem","icon","pi pi-envelope",1,"flex","no-underline",3,"href"],[1,"grid","pt-6"],[1,"image-upload","col-2","flex","align-items-center","justify-content-center"],[1,"upload-photo-img"],[1,"w-7rem","flex","align-items-center",3,"src"],[1,"user","pt-3","col-6"],[1,"mb-2"],[3,"cancel","ngModel","click","ngModelChange"],[1,"userInfo","p-4","col-4"],[1,"userPhone","flex","align-items-center","mb-3"],[3,"icon"],[1,"ml-2"],[1,"userEmail","flex","align-items-center","mb-3"],[1,"userDistrict","flex","align-items-center","mb-3"],[1,"pt-6"],[1,"mt-0",2,"font-size","2em","font-weight","lighter"],[1,"advertDiv"],["class","advert flex surface-card p-4 mb-3 shadow-2 border-round w-full",3,"routerLink",4,"ngFor","ngForOf"],[3,"showFirstLastIcon","rows","totalRecords","onPageChange"],[1,"advert","flex","surface-card","p-4","mb-3","shadow-2","border-round","w-full",3,"routerLink"],[1,"productImage",3,"src"],[1,"ml-4"],[1,"advertTitle"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"button",3),e.NdJ("click",function(){return t.back()}),e.qZA(),e.qZA(),e.TgZ(5,"div"),e._UZ(6,"a",4),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"label",7),e._UZ(10,"img",8),e.qZA(),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"h3",10),e._uU(13),e.qZA(),e.TgZ(14,"p-rating",11),e.NdJ("click",function(){return t.Rate()})("ngModelChange",function(s){return t.val=s}),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"div",12),e.TgZ(18,"div",13),e._UZ(19,"fa-icon",14),e.TgZ(20,"span",15),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"div",16),e._UZ(23,"fa-icon",14),e.TgZ(24,"span",15),e._uU(25),e.qZA(),e.qZA(),e.TgZ(26,"div",17),e._UZ(27,"fa-icon",14),e.TgZ(28,"span",15),e._uU(29),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",18),e.TgZ(31,"h2",19),e._uU(32,"An\xfancios do Utilizador"),e.qZA(),e.TgZ(33,"div",20),e.YNc(34,z,7,6,"div",21),e.qZA(),e.TgZ(35,"p-paginator",22),e.NdJ("onPageChange",function(s){return t.getAdvertsByUserId(s.page+1)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&r&&(e.xp6(6),e.MGl("href","mailto:",null==t.user?null:t.user.userEmail,"",e.LSH),e.xp6(4),e.Q6J("src",null!=(null==t.user?null:t.user.userPhotoUrl)?null==t.user?null:t.user.userPhotoUrl:"./assets/user_default.png",e.LSH),e.xp6(3),e.Oqu(null==t.user?null:t.user.userName),e.xp6(1),e.Q6J("cancel",!1)("ngModel",t.val),e.xp6(2),e.hij("Avalia\xe7\xe3o geral: ",t.rating,""),e.xp6(3),e.Q6J("icon",t.faPhoneAlt),e.xp6(2),e.Oqu(null==t.user?null:t.user.userPhoneNumber),e.xp6(2),e.Q6J("icon",t.faEnvelope),e.xp6(2),e.Oqu(null==t.user?null:t.user.userEmail),e.xp6(2),e.Q6J("icon",t.faHome),e.xp6(2),e.Oqu(null==t.user?null:t.user.districtName),e.xp6(5),e.Q6J("ngForOf",null==t.advertsArray?null:t.advertsArray.data),e.xp6(1),e.Q6J("showFirstLastIcon",!1)("rows",t.pageSize)("totalRecords",t.totalCount))},directives:[h.Hq,m.H,f.iG,l.JJ,l.On,P.BN,c.sg,I.D,d.rH],styles:[".profile[_ngcontent-%COMP%]{margin-top:17vh;font-family:Inter,sans-serif}.image-upload[_ngcontent-%COMP%]{position:relative;height:150px;width:150px;overflow:hidden}.image-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.user[_ngcontent-%COMP%]{color:#335}.userInfo[_ngcontent-%COMP%]{color:#335}.userAchivements[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#335}.advertsBody[_ngcontent-%COMP%]{margin-top:15vh;margin-bottom:10vh}.advert[_ngcontent-%COMP%]{max-height:200px}.advertDiv[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{cursor:pointer}.productImage[_ngcontent-%COMP%]{display:flex;width:150px;max-height:150px;overflow:hidden}.advertTitle[_ngcontent-%COMP%]{font-size:1.7em}span[_ngcontent-%COMP%]   .p-rating[_ngcontent-%COMP%]   .p-rating-icon.pi-star-fill[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]    {color:#ff0!important}"]}),i})()}];let j=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.Bz.forChild(D)],d.Bz]}),i})(),V=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[v.ez],imports:[[c.ez,q.F,T.j,y.x,N.d,l.u5,l.UX,M.EV,m.T,C.kW,S.JF,f.Xt,h.hJ,j,I.U]]}),i})()}}]);